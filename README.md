import pandas as pd
import numpy as np
data = {
    "메뉴":['아메리카노','카페라떼','카페모카', '바닐라라떼', '녹차', '초코라떼', '바닐라콜드브루'],
    "가격":[4100, 4600, 4600, 5100, 4100, 5000, 5100],
    "할인율":[0.5, 0.1, 0.2, 0.3, 0, 0, 0],
    "칼로리":[10, 180, 420, 320, 20, 500, 400],
    "원두":['콜롬비아', np.NaN, '과테말라', np.NaN, '한국', '콜롬비아', np.NaN],
    "이벤트가":[1900, 2300, np.NaN, 2600, np.NaN, 3000, 3200],
}
data = pd.DataFrame(data)
data.to_csv('data.csv', index=False)
df=pd.read_csv('data.csv')
# print(df.shape)

#조건필터. 1개 조건. 할인율>0.2
# con=df['할인율']>0.2
# print(df[con])
# 변수안쓰고
# print(df[df['할인율']>0.2])
# print(df['할인율']>0.2)

# #2개 이상 and. 할인율 >= 0.2 , 칼로리 < 400
# con1=df['할인율']>=0.2
# con2=df['칼로리']<400
# print(df[con1 | con2])
# print(df[con1 & con2])

# #문자열 1개 조건. 원두==콜롬비아
# con=df['원두']=='콜롬비아'
# print(df[con])

# #문자열과 숫자 조건 and. 원두==콜롬비아, 가격<4500
# con1=df['원두']=='콜롬비아'
# con2=df['가격']<4500
# print(df[con1 & con2])

# #결측치 컬럼별 확인 
# print(df.isnull())
# print(df.isnull().sum())

# #결측값 채우기. 원두의 결측값을 코스타리카로 채운값을 원두컬럼에 넣어줘야 한다.
# df['원두']=df['원두'].fillna('코스타리카')
# #이벤트가 컬럼 결측치는 1900으로 채우기
# df['이벤트가']=df['이벤트가'].fillna(1900)

# #값변경. 아메리카노->룽고, 녹차->그린티. df.replace(변경전, 변경후)
# df=df.replace('아메리카노','룽고').replace('녹차','그린티')
# # #딕셔너리 이용해서 바꾸기
# d={'아메리카노':'룽고', '녹차':'그린티'}
# df=df.replace(d)

# #숫자변경. 1900->1500
# df=df.replace(1900, 1500)

# #loc으로 값 변경. 바닐라라떼 원두-> 과테말라
# #df=에 넣으면 안된다
# df.loc[3,'원두']='과테말라'

# #이벤트가 전체 1000으로 변경
# df.loc[:, '이벤트가']=1000

#내장함수

# #카운트 컬럼. 기본값 axis=0
# print(df.count())
# # 가격      7
# # 할인율     7
# # 칼로리     7
# # 원두      4
# # 이벤트가    5
# # dtype: int64

# print(df.count(axis=1))
# # > 0    6
# # 1    5
# # 2    5
# # 3    5
# # 4    5
# # 5    6
# # 6    5
# # dtype: int64

# #데이터 수=len, shape
# print(len(df))
# print(df.shape)
# print(df['가격'].max())
# print(df['가격'].min())
# print(df['가격'].mean())
# print(df['가격'].sum())
# print(df['가격'].std())
# print(df['가격'].var())
# print(df['가격'].skew())
# print(df['가격'].kurt())

# #백분위수
# print(df.describe())
# # >       가격       할인율         칼로리         이벤트가
# # count     7.000000  7.000000    7.000000     5.000000
# # mean   4657.142857  0.157143  264.285714  2600.000000
# # std     435.343324  0.190238  196.965068   524.404424
# # min    4100.000000  0.000000   10.000000  1900.000000
# # 25%    4350.000000  0.000000  100.000000  2300.000000
# # 50%    4600.000000  0.100000  320.000000  2600.000000
# # 75%    5050.000000  0.250000  410.000000  3000.000000
# # max    5100.000000  0.500000  500.000000  3200.000000

# print(df['가격'].describe())
# # > count       7.000000
# # mean     4657.142857
# # std       435.343324
# # min      4100.000000
# # 25%      4350.000000

# #상하위 25%값
# print(df['가격'].quantile(.25))
# print(df['가격'].quantile(.75))

# 상하위 25% 데이터
# 하위 25% 데이터
# cond=df['가격'].quantile(.25)>df['가격'] # df['가격']이 4350보다 작은 조건
# print(df[cond])
# # >  메뉴    가격  할인율  칼로리    원두    이벤트가
# # 0  아메리카노  4100  0.5   10  콜롬비아  1900.0
# # 4     녹차  4100  0.0   20    한국     NaN

# #상위 25% 데이터
# cond=df['가격'].quantile(.75)< df['가격']#df['가격']이 5050보다 큰 조건
# print(df[cond])
# >         메뉴    가격  할인율  칼로리   원두    이벤트가
# 3    바닐라라떼  5100  0.3  320  NaN  2600.0
# 6  바닐라콜드브루  5100  0.0  400  NaN  3200.0

#최빈값
# print(df['원두'].mode())
# > 0    콜롬비아 -> 이것만 선택을 해야하니까 [0] 데이터 선택을 해야 한다.
# Name: 원두, dtype: object
# print(df['원두'].mode()[0])#[0]에 있는 콜롬비아만 출력

# #심화학습=apply
# #cal 함수 만들기
def cal(x):
	if x >= 300:
		return "no"
	else: #300미만이면 yes
		return "yes"

# print(df['칼로리'].apply(cal))
# > 0    yes
# 1    yes
# 2     no
# 3     no
# 4    yes
# 5     no
# 6     no
# Name: 칼로리, dtype: object

# #apply 적용해서 새로운 컬럼 생성=칼로리 컬럼 활용
# df['possible']=df['칼로리'].apply(cal) => 피처엔지니어링, apply이용해서 새로운 컬럼 생성
# >    메뉴    가격  할인율  칼로리    원두    이벤트가 possible
# 0    아메리카노  4100  0.5   10  콜롬비아  1900.0      yes
# 1     카페라떼  4600  0.1  180   NaN  2300.0      yes
# 2     카페모카  4600  0.2  420  과테말라     NaN       no
# 3    바닐라라떼  5100  0.3  320   NaN  2600.0       no
# 4       녹차  4100  0.0   20    한국     NaN      yes
# 5     초코라떼  5000  0.0  500  콜롬비아  3000.0       no
# 6  바닐라콜드브루  5100  0.0  400   NaN  3200.0       no
# print()
# print()
# print()
# print()
# print()

# #그룹핑 groupby(). 원두 기준, 평균
# print(df.groupby('원두').mean())
# >           가격   할인율    칼로리    이벤트가
# 원두                               
# 과테말라  4600.0  0.20  420.0     NaN
# 콜롬비아  4550.0  0.25  255.0  2450.0
# 한국    4100.0  0.00   20.0     NaN

# #원두와 할인율 기준 평균
# print(df.groupby(['원두','할인율']).mean())
# >           가격    칼로리    이벤트가
# 원두   할인율                       
# 과테말라 0.2  4600.0  420.0     NaN
# 콜롬비아 0.0  5000.0  500.0  3000.0
#         0.5  4100.0   10.0  1900.0
# 한국     0.0  4100.0   20.0     NaN

# #원두와 할인율 기준, 가격의 평균=가격만
# print(df.groupby(['원두', '할인율'])['가격'].mean())
#컬럼을 하나만 선택하면 시리즈 형태로 반환한다.
# > 원두    할인율
# 과테말라  0.2    4600.0
# 콜롬비아  0.0    5000.0
#          0.5    4100.0
# 한국      0.0    4100.0
# Name: 가격, dtype: float64 -> 위의 시리즈 형태의 결과값을 데이터프레임으로 바꿀때는 
# pd.DataFrame() 괄호안에 위의 코드를 넣으면 된다.
# print(pd.DataFrame(df.groupby(['원두','할인율'])['가격'].mean()))
# >               가격
# 원두   할인율        
# 과테말라 0.2  4600.0
# 콜롬비아 0.0  5000.0
#         0.5  4100.0
# 한국    0.0  4100.0 #데이터프레임으로출력

#리인덱싱= 위의 df형태를 1개 인덱스 형태로 리셋
#멀티인덱스의 데이터프레임
# print(df.groupby(['원두','할인율']).mean())
# >            가격    칼로리    이벤트가 #멀티인덱스의 데이터프레임
# 원두   할인율                       
# 과테말라 0.2  4600.0  420.0     NaN
# 콜롬비아 0.0  5000.0  500.0  3000.0
#         0.5  4100.0   10.0  1900.0
# 한국     0.0  4100.0   20.0     NaN

# 리인덱싱 -> .reset_index()
# print(df.groupby(['원두','할인율']).mean().reset_index()) #리인덱싱
# >   원두  할인율      가격    칼로리    이벤트가
# 0  과테말라  0.2  4600.0  420.0     NaN
# 1  콜롬비아  0.0  5000.0  500.0  3000.0
# 2  콜롬비아  0.5  4100.0   10.0  1900.0
# 3    한국  0.0  4100.0   20.0     NaN

#퀴즈
#1.이벤트가 결측치를 최소값으로 채운다.
min=df['이벤트가'].min()
# print(min) #1900
df['이벤트가']=df['이벤트가'].fillna(min)
# >    메뉴    가격  할인율  칼로리    원두    이벤트가
# 0    아메리카노  4100  0.5   10  콜롬비아  1900.0
# 1     카페라떼  4600  0.1  180   NaN  2300.0
# 2     카페모카  4600  0.2  420  과테말라  1900.0
# 3    바닐라라떼  5100  0.3  320   NaN  2600.0
# 4       녹차  4100  0.0   20    한국  1900.0
# 5     초코라떼  5000  0.0  500  콜롬비아  3000.0
# 6  바닐라콜드브루  5100  0.0  400   NaN  3200.0

#2.원두 컬럼 결측치는 최빈값 mode()[0]
fre=df['원두'].mode()[0]
# print(fre) #콜롬비아
df['원두']=df['원두'].fillna(fre)
# >    메뉴    가격  할인율  칼로리    원두    이벤트가
# 0    아메리카노  4100  0.5   10  콜롬비아  1900.0
# 1     카페라떼  4600  0.1  180  콜롬비아  2300.0
# 2     카페모카  4600  0.2  420  과테말라  1900.0
# 3    바닐라라떼  5100  0.3  320  콜롬비아  2600.0
# 4       녹차  4100  0.0   20    한국  1900.0
# 5     초코라떼  5000  0.0  500  콜롬비아  3000.0
# 6  바닐라콜드브루  5100  0.0  400  콜롬비아  3200.0

#3. 가격 >= 5000 인 데이터의 수
cond=df['가격']>=5000
print(df[cond].count())
print(len(df[cond]))
# print(df)
# # >     메뉴    가격  할인율  칼로리    원두    이벤트가
# # 0    아메리카노  4100  0.5   10  콜롬비아  1900.0
# # 1     카페라떼  4600  0.1  180   NaN  2300.0
# # 2     카페모카  4600  0.2  420  과테말라     NaN
# # 3    바닐라라떼  5100  0.3  320   NaN  2600.0
# # 4       녹차  4100  0.0   20    한국     NaN
# # 5     초코라떼  5000  0.0  500  콜롬비아  3000.0
# # 6  바닐라콜드브루  5100  0.0  400   NaN  3200.0
